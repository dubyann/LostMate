## 数据库设计

数据库设计是确保平台数据信息存储和用户帖子关系管理有效性的关键步骤。在本小节中，我们将根据系统功能模块的设计，构建一个结构合理、高效且可扩展的数据库，以支持系统业务的多个不同功能模块。

系统数据库的设计分为逻辑结构设计和物理结构设计两个方面。逻辑结构设计是数据库设计过程中的首要步骤。它涉及定义数据的逻辑关系，包括确定实体、实体之间的关系以及数据的属性。此外，我们还需要考虑表之间的关系，如一对多或多对多关系，并通过外键来实现这些关系。物理结构设计则关注数据库在存储介质上的实际布局。这包括确定索引策略来优化查询性能和选择合适的存储引擎以满足不同的读写需求。

本系统采用MySQL作为系统开发数据库。

### 逻辑结构设计

在校园生活服务平台中，数据库的设计对于整个系统的功能实现至关重要。该平台允许用户在不同的板块发布帖子，表达他们的诉求和需要，而管理员则负责审核这些帖子，确保内容的合规性。为了保障数据库的高效运作和数据的准确性，我们首先对逻辑结构进行了精心设计，确立了系统中各个数据库实体的关系。

针对校园生活服务平台，我们设计的数据库实体涵盖了用户、帖子、板块、管理员等核心组件。每个实体都有其特定的属性信息，以及与其他实体之间的逻辑联系。

通过具体的E-R图（实体-关系图），我们能够清晰地展示出这些数据库实体的属性信息以及它们之间的联系。本平台详细E-R图如图x.22所示

![avator](image\E-R图.png)

> 图x.22 校园生活服务平台E-R图

### 物理结构设计

根据上文对系统数据库的逻辑设计以及数据库设计基本理论，校园生活服务平台主要数据用表如表b.10所示。

| 序号 | 数据表          | 数据表描述 |
| ---- | --------------- | ---------- |
| 1    | users           | 用户信息表 |
| 2    | posts           | 帖子信息表 |
| 3    | posts_approvals | 审核信息表 |
| 4    | comments        | 评论信息表 |

> 表b.10 系统主要数据表清单

系统关键数据表设计详情如下：

1.用户信息表，表名为users，数据设计详情如表b.11所示。

| 字段名       | 描述     | 字段类型                         | 可空 | 默认值   | 主键 |
| ------------ | -------- | -------------------------------- | ---- | -------- | ---- |
| user_id      | 用户id   | int                              | 否   | 无       | 是   |
| username     | 用户名   | varchar(50)                      | 否   | 无       | 否   |
| password     | 密码     | varchar(255)                     | 否   | 无       | 否   |
| email        | 邮箱     | varchar(255)                     | 否   | 无       | 否   |
| status       | 帐号状态 | enum('normal','frozen','banned') | 否   | ’normal‘ | 否   |
| role         | 角色     | enum('user','admin')             | 否   | ’user‘   | 否   |
| image_url    | 头像URL  | varchar(255)                     | 是   | 无       | 否   |
| phone_number | 手机号   | varchar(20)                      | 是   | 无       | 否   |
| birthday     | 生日     | date                             | 是   | 无       | 否   |
| address      | 地址     | text                             | 是   | 无       | 否   |

> 表b.11 用户信息数据表

2.帖子信息表，表名为posts，数据设计详情如表b.12所示。

| 字段名    | 描述     | 字段类型                              | 可空 | 默认值    | 主键 |
| --------- | -------- | ------------------------------------- | ---- | --------- | ---- |
| post_id   | 帖子id   | int                                   | 否   | 无        | 是   |
| usee_id   | 用户id   | int                                   | 否   | 无        | 否   |
| type      | 帖子类型 | enum('friends','lost','trade')        | 否   | 无        | 否   |
| title     | 帖子标题 | varchar(255)                          | 否   | 无        | 否   |
| content   | 帖子内容 | text                                  | 否   | 无        | 否   |
| image_url | 帖子封面 | varchar(255)                          | 是   | 无        | 否   |
| status    | 帖子状态 | enum('pending','approved','rejected') | 是   | ’pending‘ | 否   |

> 表b.12 帖子信息数据表

3.审核信息表，表名为posts_approvals，数据设计详情如表b.13所示。

| 字段名      | 描述     | 字段类型                    | 可空 | 默认值 | 主键 |
| ----------- | -------- | --------------------------- | ---- | ------ | ---- |
| approval_id | 审核id   | int                         | 否   | 无     | 是   |
| post_id     | 帖子id   | int                         | 否   | 无     | 否   |
| admin_id    | 管理员id | int                         | 否   | 无     | 否   |
| status      | 帖子状态 | enum('approved','rejected') | 否   | 无     | 否   |
| reason      | 审核原因 | text                        | 是   | 无     | 否   |

> 表b.13 审核信息数据表

4.评论信息表，表名为comments，数据设计详情如表b.14所示。

| 字段名     | 描述           | 字段类型 | 可空 | 默认值 | 主键 |
| ---------- | -------------- | -------- | ---- | ------ | ---- |
| comment_id | 评论id         | int      | 否   | 无     | 是   |
| post_id    | 帖子id         | int      | 否   | 无     | 否   |
| user_id    | 用户(评论者)id | int      | 否   | 无     | 否   |
| content    | 评论内容       | text     | 否   | 无     | 否   |

> 表b.14 评论信息数据表